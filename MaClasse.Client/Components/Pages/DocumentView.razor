@page "/documents/view/{ConcatString}"

<PageTitle>Document : @(document?.Name ?? "Chargement...")</PageTitle>

@* <LayoutView Layout="@typeof(Layout.MainLayout)"> *@
    <div class="d-flex flex-column align-items-center justify-content-center p-4">
        @if (isLoading)
        {
            <MudProgressCircular Indeterminate Color="Color.Primary" />
            <MudText Class="mt-2">Chargement du document...</MudText>
        }
        else if (document != null)
        {
            <h3 class="mb-4">Visualisation : @document.Name</h3>

            @if (IsPdf(document.Format))
            {
                <object data="@document.Url" type="application/pdf" width="100%" height="600px">
                    <p>Votre navigateur ne supporte pas l'affichage des PDFs intégrés. Vous pouvez <a href="@document.Url" target="_blank">télécharger le PDF ici</a>.</p>
                </object>
            }
            else if (IsImage(document.Format))
            {
                <img src="@document.Url" alt="@document.Name" style="max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 4px;"/>
            }
            else
            {
                <MudText Typo="Typo.h5" Color="Color.Error">Type de fichier non pris en charge pour l'affichage direct.</MudText>
                <MudButton Href="@document.Url" Target="_blank" Variant="MudBlazor.Variant.Filled" Color="Color.Primary" Class="mt-4">Télécharger le fichier</MudButton>
            }
        }
        else
        {
            <MudText Typo="Typo.h5" Color="Color.Warning">Document introuvable ou URL manquante.</MudText>
        }

        @* @if (document != null && string.IsNullOrEmpty(errorMessage)) *@
        @* { *@
        @*     <MudButton OnClick="NavigateBack" Variant="MudBlazor.Variant.Outlined" Color="Color.Secondary" Class="mt-5">Retour</MudButton> *@
        @* } *@
    </div>
@* </LayoutView> *@

@code {
    // ... (le code-behind C# de DocumentView ci-dessus)

    [Inject]
    public NavigationManager NavigationManager { get; set; }

    private bool IsPdf(string mimeType) => mimeType?.Equals("application/pdf", StringComparison.OrdinalIgnoreCase) == true;
    private bool IsImage(string mimeType) => mimeType?.StartsWith("image/") == true;

    private void NavigateBack()
    {
        // NavigationManager.NavigateBack();
    }
}